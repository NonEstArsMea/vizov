{% extends "base.html" %}

{% block title %}–ú–æ–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è - Vizov01.ru{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/style_profile_bookings.css') }}">
{% endblock %}

{% block content %}
<section class="bookings-section fade-in">
    <div class="bookings-container">
        <div class="bookings-header">
            <h1 class="bookings-title">–ú–û–ò –ë–†–û–ù–ò–†–û–í–ê–ù–ò–Ø</h1>
            <p class="bookings-subtitle">–í–∞—à–∏ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è</p>
            <a href="/calendar" class="new-booking-btn">
                üóìÔ∏è –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –µ—â–µ
            </a>
        </div>

        {% if bookings %}
        <div class="bookings-grid">
            {% for booking in bookings %}
            <div class="booking-card" data-status="{{ 'confirmed' if booking.booked else 'pending' }}">
                <div class="booking-header">
                    <div class="booking-badge {% if booking.booked %}confirmed{% else %}pending{% endif %}">
                        {{ '‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ' if booking.booked else '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ' }}
                    </div>
                    <div class="booking-urgency {% if booking.soon %}soon{% endif %}">
                        {{ 'üî• –°–∫–æ—Ä–æ!' if booking.soon else 'üìÖ –í –ø–ª–∞–Ω–∞—Ö' }}
                    </div>
                </div>

                <div class="booking-content">
                    <h3 class="booking-title">{{ booking.title }}</h3>

                    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                    <div class="booking-details active">
                        <div class="detail-item">
                            <span class="detail-icon">üìÖ</span>
                            <div class="detail-content">
                                <strong>–î–∞—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</strong>
                                <span class="detail-value">{{ booking.date }}</span>
                            </div>
                        </div>

                        <div class="detail-item">
                            <span class="detail-icon">‚è∞</span>
                            <div class="detail-content">
                                <strong>–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ</strong>
                                <span class="detail-value">{{ booking.booking_date }}</span>
                            </div>
                        </div>

                        <div class="detail-item">
                            <span class="detail-icon">üë•</span>
                            <div class="detail-content">
                                <strong>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</strong>
                                <span class="detail-value">{{ booking.participants or '1 —á–µ–ª–æ–≤–µ–∫' }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                    <div class="booking-info">
                        <div class="info-item">
                            <span class="info-icon">üìç</span>
                            <div class="info-content">
                                <strong>–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è</strong>
                                <span class="info-value">–ë–∞–∑–∞ "–≠–∫—Å—Ç—Ä–∏–º –ü–∞—Ä–∫", –ú–æ—Å–∫–≤–∞</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <span class="info-icon">‚è±Ô∏è</span>
                            <div class="info-content">
                                <strong>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong>
                                <span class="info-value">4 —á–∞—Å–∞</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <span class="info-icon">üéØ</span>
                            <div class="info-content">
                                <strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å</strong>
                                <span class="info-value">–í—ã—Å–æ–∫–∞—è</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <span class="info-icon">üëï</span>
                            <div class="info-content">
                                <strong>–ß—Ç–æ –Ω–∞–¥–µ—Ç—å</strong>
                                <span class="info-value">–°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è —Ñ–æ—Ä–º–∞, –∫—Ä–æ—Å—Å–æ–≤–∫–∏</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <span class="info-icon">üìù</span>
                            <div class="info-content">
                                <strong>–ß—Ç–æ –≤–∑—è—Ç—å —Å —Å–æ–±–æ–π</strong>
                                <span class="info-value">–°–º–µ–Ω–Ω—É—é –æ–¥–µ–∂–¥—É, –ø–æ–ª–æ—Ç–µ–Ω—Ü–µ, –≤–æ–¥—É</span>
                            </div>
                        </div>
                    </div>

                    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ -->
                    <div class="preparation-progress">
                        <div class="progress-header">
                            <span>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—é</span>
                            <span class="progress-percent">65%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 65%"></div>
                        </div>
                        <div class="progress-steps">
                            <span class="step completed">‚úÖ –ë—Ä–æ–Ω—å</span>
                            <span class="step completed">‚úÖ –û–ø–ª–∞—Ç–∞</span>
                            <span class="step current">üìù –ê–Ω–∫–µ—Ç–∞</span>
                            <span class="step">üéØ –ò–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂</span>
                        </div>
                    </div>
                </div>

                <div class="booking-actions">
                    <button class="action-btn primary toggle-info-btn">
                        <span class="toggle-icon">üìñ</span>
                        <span class="toggle-text">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</span>
                    </button>
                    <button class="action-btn secondary share-btn">
                        üîó –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                    </button>
                    <button class="action-btn danger cancel-btn" data-booking-id="{{ booking.id }}">
                        ‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π -->
        <div class="bookings-stats">
            <div class="stat-card">
                <div class="stat-icon">üìÖ</div>
                <div class="stat-info">
                    <span class="stat-number">{{ bookings|length }}</span>
                    <span class="stat-label">–í—Å–µ–≥–æ –±—Ä–æ–Ω–µ–π</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-info">
                    <span class="stat-number">{{ bookings|selectattr('booked')|list|length }}</span>
                    <span class="stat-label">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üî•</div>
                <div class="stat-info">
                    <span class="stat-number">{{ bookings|selectattr('soon')|list|length }}</span>
                    <span class="stat-label">–°–∫–æ—Ä–æ</span>
                </div>
            </div>
        </div>

        {% else %}
        <div class="empty-bookings">
            <div class="empty-icon">üéØ</div>
            <h2 class="empty-title">–ë–†–û–ù–ò–†–û–í–ê–ù–ò–ô –ù–ï–¢</h2>
            <p class="empty-text">
                –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π. –°–∞–º–æ–µ –≤—Ä–µ–º—è –≤—ã–±—Ä–∞—Ç—å
                —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –¥—É—à–µ –∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Å–≤–æ—é –∑–∞—è–≤–∫—É!
            </p>
            <div class="empty-actions">
                <a href="/calendar" class="empty-btn primary">
                    üóìÔ∏è –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å
                </a>
                <a href="/anons" class="empty-btn secondary">
                    üì¢ –°–º–æ—Ç—Ä–µ—Ç—å –∞–Ω–æ–Ω—Å—ã
                </a>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–º–µ–Ω—ã –±—Ä–æ–Ω–∏ -->
<div id="cancelModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>‚ùå –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
            <span class="modal-close">&times;</span>
        </div>
        <div class="modal-body">
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?</p>
            <div class="booking-preview">
                <strong id="modalBookingTitle"></strong>
                <span id="modalBookingDate"></span>
            </div>
            <div class="cancellation-reasons">
                <label>–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–º–µ–Ω—ã (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
                <select id="cancelReason">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É...</option>
                    <option value="schedule">–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤</option>
                    <option value="health">–ü—Ä–æ–±–ª–µ–º—ã —Å–æ –∑–¥–æ—Ä–æ–≤—å–µ–º</option>
                    <option value="financial">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã</option>
                    <option value="other">–î—Ä—É–≥–æ–µ</option>
                </select>
                <textarea id="cancelComment" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
            </div>
        </div>
        <div class="modal-actions">
            <button class="modal-btn secondary" id="cancelNo">–ù–µ—Ç, –æ—Å—Ç–∞–≤–∏—Ç—å</button>
            <button class="modal-btn danger" id="cancelYes">–î–∞, –æ—Ç–º–µ–Ω–∏—Ç—å</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/profile_bookings.js') }}"></script>
{% endblock %}